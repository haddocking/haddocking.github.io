# Input files

Over the years, HADDOCK was updated to increase the range of biomolecular entities to be delt with.
Currently, we support a broad range of molecular types, such as protein, DNA, RNA, glycans, cyclic-peptides and small-molecules.
In addition, several modified residues/nucleotides are also available.
For the full list of supported molecules, please refere to: [https://wenmr.science.uu.nl/haddock2.4/library](https://wenmr.science.uu.nl/haddock2.4/library).
If you wish to work with a molecule type that is not present in this list, please refere to the [Dealing with non-standard molecules section](#dealing-with-non-standard-molecules).


In the following sections, we will tackle the variety and specificity of each of the molecule types.


## Supported file format

Haddock3 currently supports files in PDB and mmCIF format.
The PDB format is quite strict, and all characters must be well positionned in the file.

To make sure your file is correctly formated, you can use the `pdbtools` library (should be already installed in your `haddock3` virtual environement),
or read [this online resource](https://cupnet.net/pdb-format/) where it is well explained.

Please refere to the [pdb-tools](./pdbtools.md) section for more information on how to use it.


## Number of input molecules 

Haddock3 currently supports up to 20 separate input molecules, thus allowing multi-body (1 <= N <= 20) docking.
Each input molecule can be composed of an [ensemble of conformations](#conformational-ensemble), allowing to implicitly represent the conformational sampling.
Input molecules can also be composed of multiple chains, allowing for their evaluation using scoring and analysis modules.

To input molecules, use the [global parameter](/software/haddock3/manual/global_parameters) `molecules = ["path/to/mol1.pdb", "path/to/mol2.pdb"]`.


## Definition of a chain

A chain is defined by a letter in the 22<sup>nd</sup> position in the PDB file format.
Within the same file, two chains must be separated by a `TER` statment.
Do not worry if you have gaps (missing resiudes) in your chain, it will be automatically detected by HADDOCK.
To make sure the structure do not fall appart during molecular dynamics steps, you can add [`body-restraints`](/software/haddock3/manual/restraints_cli.md#body-restraints) ensuring the constant distance originally observed in the input file.


## Conformational ensemble

Conformational ensembles are detected using the `MODEL` and `ENDMDL` keywords in the PDB file.
Note that if in your ensemble, we detect two types of `REMARK` statments when providing an ensemble:

- `REMARK     MODEL X FROM conformationX.pdb`: as generated by `pdb_mkensemble`, we will keep track of the origin of the conformation.
- `REMARK   X MODEL Y MD5 XXXXXXXXXXXXXXXXXX`: as provided by CAPRI scroing set, we will keep track of the MD5 checksum of the input conformation/model.


## Dealing with non-standard molecules

If you wish to work with a molecule type that is not present in the [list of supported molecules](https://rascar.science.uu.nl/haddock2.4/library), do not worry, as you will still be able to use HADDOCK.
To properly function, HADDOCK require to have access to the topology and parameters of a molecule to run the molecular dynamics protocols.
The force-field must therefore be updated by user provided topology and parameter files.

In modules that uses CNS, you can provide such files with the `ligand_top_fname` (for ligand topology filename) and `ligand_param_fname` (for ligand parameters filename) parameters, specifying the location where to find those two files.


### How to generate topology and parameters for my ligand

Generating topology and parameters for your ligand is not trivial.
For this, you will need to use dedicated tools, such as `acpype` or [`ccp4-prodrg`](https://www.ccp4.ac.uk/html/index.html), or use dedicated libraries such as [`bioBB`](https://mmb.irbbarcelona.org/biobb/).

Here are some usefull resources on how to generate those:

- **bioBB using acpype**: https://mmb.irbbarcelona.org/biobb/workflows/tutorials/biobb_wf_ligand_parameterization.
* **Automated Topology Builder (ATB)**: Repository developed in Prof. Alan Mark's group at the University of Queensland in Brisbane: [https://atb.uq.edu.au/](https://atb.uq.edu.au/).