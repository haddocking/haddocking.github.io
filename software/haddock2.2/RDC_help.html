---
layout: page
tags: [Jekyll, HADDOCK, Bonvin, Docking, Simulation, Molecular Dynamics, Structural Biology, Computational Biology, Modelling, Protein Structure]
modified: 2014-08-08T20:53:07.573882-04:00
comments: false
image:
  feature: pages/banner_software.jpg
---

<H1><FONT COLOR=RED>HADDOCK2.2</FONT COLOR=RED> manual</H1>

<H2 align=right><FONT COLOR=RED>U</FONT>sing 
		<FONT COLOR=RED>R</FONT>esidual 
		<FONT COLOR=RED>D</FONT>ipolar 
		<FONT COLOR=RED>C</FONT>ouplings
</H2>
<HR>
<BR>
Residual dipolar couplings (RDCs) can provide useful information on the orientation of the
molecules to be docked. They can be introduced in HADDOCK in two ways:
<ul>
  <li> Directly as <a href="#sani">RDC restraints</a> (SANI statement in CNS)
  <li> Indirectly by defining <a href="#vean">intervector projection angle restraints</a> (VEAN statement in CNS)
</ul>
<BR>
From our experience, both approaches give good results for docking. The use of 
intervector projection angle restraints 
(<a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&list_uids=10805131&dopt=Abstract">
Meiler et al. <i>J. Biomol. NMR</i> <b>17</b>, 185 (2000)</a>) avoids the 
burden of working with a tensor in the structure calculations. Another advantage 
is that one can distinguish between inter- and intra-molecular restraints. Considering 
that part of the system will typically be kept rigid during docking, the use of intra-molecular 
restraints might not make much sense anyway.
<BR>
<BR>
For both, the tensor components need first to be determined. In the case of complexes, this
can be easily done by using the known structures of the single domains. The software
<a href="http://spin.niddk.nih.gov/bax/software/PALES/index.html">Pales</a> 
(Zweckstetter & Bax (2000). <i>J. Am. Chem. Soc.</i> <b>122</b>, 3791-3792) can 
be used for this purpose.
<BR>
<BR>
You need for this to generate a <a href="http://spin.niddk.nih.gov/bax/software/PALES/index.html#DF">
Pales input file</a> containing your residual dipolar couplings.
<BR>
<BR>
A csh script called <i>ana_pdb_Q-factor.csh</i> is provided in the 
<b>haddock/tools</b> directory that will calculate from the experimental
dipolar coupling the tensor parameters for all PDB files present in the 
current directory by best-fitting the dipolar coupling tensor to the
corresponding 3D structures.
<BR>
<BR>
Usage:
<pre>
   $HADDOCK/tools/ana_pdb_Q-factor.csh pales.inp
</pre>
The output will be written to files with extension <i>PDBfilename.pales</i>.
<BR>
The tensor parameters Axx, Ayy and Azz can then be extracted with the following 
command:
<BR>
<pre>
    grep Axx *.pales | gawk '{print $4,$5,$6}' > xx-yy-zz.dat
</pre>
<BR>
The components from the structure giving the best fit to the 
experimental data can be used.
<BR>
Alternatively, the average values can then be calculated with:
<BR>
<pre>
   cat xx-yy-zz.dat | awk '{print $1}' | $HADDOCKTOOLS/average.perl
   cat xx-yy-zz.dat | awk '{print $2}' | $HADDOCKTOOLS/average.perl
   cat xx-yy-zz.dat | awk '{print $3}' | $HADDOCKTOOLS/average.perl
</pre>
<BR>
Check the values in xx-yy-zz.dat to make sure they match (e.g. same sign) 
before averaging them.
<BR>
Similarly, the axial (Da) and rhombic (Dr) components can be extracted from the
Pales1.2 output files and averaged with the following command:
<BR>
<pre>
   grep Da *.pales | awk '{print $3}' | $HADDOCKTOOLS/average.perl
   grep Dr *.pales | awk '{print $3}' | $HADDOCKTOOLS/average.perl
</pre>
<BR>
<b><i>Note:</i></b> For use in HADDOCK (and CNS), the tensor components should
      be expressed in Hertz and the Pales values should be scaled depending on
      the nuclei observed. For example, for N-H residual dipolar coupling the 
      proper scaling factor is 21700. <b>Also be careful in the conversion since
      different programs often use different conventions/notations/units</b>.
<BR>
<hr>
<BR>
<BR>
<a name="sani"><b><u> Direct use of RDCs as restraints for docking</u></b></a>
<BR>
<BR>
The proper format for RDC restraints is the following:
<pre>
assi ( resid 999 and name OO )
     ( resid 999 and name Z  )
     ( resid 999 and name X  )
     ( resid 999 and name Y  )
     ( resid   20 and name N and segid A )
     ( resid   20 and name HN and segid A )   2.981   0.200
</pre>
Given a file containing <i>residue_number RDC_value</i> and <i>Segid</i> a RDC
restraint file in CNS format can be generated with the gawk script 
<i>generate_sani</i> provided in the <b>HADDOCK/RDCtools</b> directory:
<pre>
    $HADDOCK/RDCtools/generate_sani rdc_data_file
</pre>
The error on the RDCs is set by default to 0.2 Hz. This can be overruled by
giving the error value as argument:
<pre>
    $HADDOCK/RDCtools/generate_sani ERR=0.4 rdc_data_file
</pre>
The 2.2 version of HADDOCK supports up to 5 different SANI restraints sets. Each can have a separate tensor.
The tensor residue number should be in the range 999-995. You can edit and modify the <i>generate_sani</i> script to change the tensor number.
To use RDC restraints in HADDOCK, use <i>SANI</i> in <a HREF="http://www.bonvinlab.org/software/haddock2.2/run#dipo">run.cns</a>
in the dipolar coupling section and define the proper Da and R parameters (R=Dr/Da). 
The RDC restraints are first used in the 
<a HREF="http://www.bonvinlab.org/software/haddock2.2/docking#mini">rigid body energy minimization step</a> using
as force constant the value defined for the hot phase. Keep this value small 
(the current default is 0.02) to keep a proper balance between the AIR and
SANI energy terms. 
<BR>
<ul>
<b><i>Note 1:</i></b> Only one set (corresponding to one alignment tensor) of dipolar 
          couplings can be used as direct restraints (SANI) in HADDOCK since currently
          only one alignment tensor is supported. Multiple sets can however be used as intervector
          projection angle restraints (see below).
<p>
<b><i>Note 2:</i></b> For proper docking results, dipolar couplings restraints of the various molecules
          should be input as one set (and thus not split in separate sets for each molecule). The
          assumption here is that the RDCs of the various components share one common alignment
          tensor.
</ul><p>
<hr>
<BR>
<BR>
<a name="vean"><b><u> Intervector projection angle restraints for docking</u></b></a>
<BR>
<BR>
Intervector projection angle restraints (<a href="http://www.ncbi.nlm.nih.gov/entrez/query.fcgi?cmd=Retrieve&db=PubMed&list_uids=10805131&dopt=Abstract">
Meiler et al. <i>J. Biomol. NMR</i> <b>17</b>, 185 (2000)</a>) are obtained by taking
pairs of residual dipolar couplings and generating intervector projection
angle restraints (somewhat equivalent to dihedral angle restraints). These
restraints have the advantage that they do no longer depend on the orientation
of the dipole vector with respect to the alignment tensor. Instead they restrain
the angle between two dipolar vectors, allowing for two minima. Two force constants
must be therefore defined: one for the border potential function and one for the
central part (e.g. between the two minima).
<p>
Thanks to Helen Mott and Wayne Boucher from Cambridge University we are providing
in the <b>HADDOCK/RDCtools</b> a python script, <i>dipole_segid.py</i> that 
allows the generation of such restraints from RDC data. To use it, you need
to have your RDC data in a tab separated file containing <i>residue_number,
RDC_value</i> and <i>Segid</i> and provide the tensor components Dxx, Dyy and
Dzz  (in Hertz). For NH couplings, these components are equal to 21700 times the
eigenvalues of the Saupe matrix given by Pales.
<p>
Usage:
<pre>
    python $HADDOCK/RDCtools/dipolar_segid.py rdc_data_file vean_output_file Dxx Dyy Dzz
</pre>
The resulting restraints file looks like:
<pre>
    assign (resid 19 and name N and segid     B ) (resid 19 and name HN and segid     B ) (resid 27 and name N and segid     B ) (resid 27 and name HN and segid     B ) 13.1 2.9 166.9 2.9 ! excluded 0.935
    assign (resid 75 and name N and segid     A ) (resid 75 and name HN and segid     A ) (resid 27 and name N and segid     B ) (resid 27 and name HN and segid     B ) 13.1 2.9 166.9 2.9 ! excluded 0.935
</pre>
The last column gives the fraction of angular space excluded by the restraint and
can be used to select "significant" restraints, e.g. limiting more than 25% of 
the torsional space. Note that the number of restraints generated is very high
since for N dipolar coupling there are N*(N-1) possible combinations.
<BR>
To select for example all inter- and intra-molecular restraint excluding more 
than 25% of the angular space type:
<pre>
    awk '{if ($27 == $9 && $44 > 0.25) {print $0}}' vean_output_file >vean_intra_25.tbl
    awk '{if ($27 != $9 && $44 > 0.25) {print $0}}' vean_output_file >vean_inter_25.tbl
</pre>
To use intervector projection angle restraints in HADDOCK, use <i>VANGLE</i> 
in <a HREF="http://www.bonvinlab.org/software/haddock2.2/run#dipo">run.cns</a> in the dipolar coupling section. The VANGLE 
restraints are introduced in the <a HREF="http://www.bonvinlab.org/software/haddock2.2/docking#mini">
rigid body energy minimization step</a> using as initial force constants the 
value defined for the hot phase. The restraints are activated in the second
rotational minimization phase (thus earlier than the SANI restraints!)
<hr>
